<!DOCTYPE html>
<html lang="tr" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"
    />
    <title>v1.0.28 PWA</title>

    <!-- PWA Meta Etiketleri -->
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#111827" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <link rel="apple-touch-icon" href="img/apple-touch-icon.png" />

    <!-- Mevcut Scriptler -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
      };
      // Önbellek için timestamp
      const timestamp = new Date().getTime();
    </script>

    <!-- Mevcut Stiller -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body
    class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen"
  >
    <div
      id="app"
      class="container mx-auto px-4 py-4 h-screen flex flex-col max-w-5xl"
    >
      <!-- Sekme Başlıkları -->
      <div class="flex space-x-2 mb-4">
        <button
          id="camera-tab"
          class="flex-1 py-2 px-4 rounded-t-lg bg-blue-500 text-white hover:bg-blue-600 transition-colors"
        >
          Kamera
        </button>
        <button
          id="gallery-tab"
          class="flex-1 py-2 px-4 rounded-t-lg bg-gray-500 text-white hover:bg-gray-600 transition-colors"
        >
          Galeri (<span id="photo-count">0</span>)
        </button>
      </div>

      <!-- Ana İçerik Alanı -->
      <div class="flex-1 overflow-hidden">
        <!-- Kamera Bölümü -->
        <div id="camera-section" class="h-full flex flex-col">
          <div
            id="camera-container"
            class="flex-1 relative bg-black rounded-lg overflow-hidden"
          >
            <video
              id="camera-preview"
              autoplay
              playsinline
              class="absolute inset-0 w-full h-full object-cover"
            ></video>

            <div id="guide-overlay" class="absolute inset-0">
              <div id="crop-guide" class="border-2 border-white"></div>
            </div>

            <button
              id="capture-btn"
              class="absolute bottom-4 left-1/2 transform -translate-x-1/2 w-16 h-16 bg-white rounded-full shadow-lg flex items-center justify-center"
            >
              <div class="w-14 h-14 bg-red-500 rounded-full"></div>
            </button>
          </div>
        </div>

        <!-- Galeri Bölümü -->
        <div id="gallery-section" class="h-full hidden">
          <div
            id="gallery-grid"
            class="grid grid-cols-2 md:grid-cols-4 gap-4"
          ></div>
          <div class="mt-4 flex justify-end space-x-2">
            <button
              id="share-btn"
              class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
            >
              Paylaş
            </button>
            <button
              id="download-btn"
              class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600"
            >
              İndir
            </button>
            <button
              id="delete-all-btn"
              class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600"
            >
              Tümünü Sil
            </button>
          </div>
        </div>
      </div>

      <!-- Alt butonlar -->
      <div class="bottom-actions">
        <button class="btn-debug" onclick="window.app.debug.toggle()">
          Debug Log
        </button>
        <button
          class="btn-clear"
          onclick="window.app.gallery.deleteAllPhotos()"
        >
          Temizle
        </button>
        <button
          class="btn-export"
          onclick="window.app.gallery.downloadPhotos()"
        >
          Dışa Aktar
        </button>
        <button class="btn-share" onclick="window.app.gallery.sharePhotos()">
          Paylaş
        </button>
      </div>
    </div>

    <!-- PWA Service Worker Kaydı -->
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("service-worker.js")
            .then((registration) => {
              console.log("Service Worker kaydedildi:", registration);
            })
            .catch((error) => {
              console.error("Service Worker kaydı başarısız:", error);
            });
        });
      }
    </script>

    <!-- Ana Uygulama -->
    <script type="module" src="js/main.js?v=${timestamp}"></script>
  </body>
</html>
